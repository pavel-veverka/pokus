<!DOCTYPE html>
<!--
    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
     KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.
-->
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/index.css" />
        <title>Hello World</title>
    </head>
    <body>
        <h1>My awesome service</h1>
        <p>Is appear.in compatible? <span id="compatability-test-result">Maybe</span></p>
        <button id="create-room-button">Create room</button>
        <button id="join-room-button">Join room</button>

        <iframe width="400" height="400" id="appearin-room"></iframe>



        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
        <script src="http://iswebrtcready.appear.in/apiv2.js"></script>

        <script>            
            document.getElementById('create-room-button').onclick = function () {
                // create the room on button press
                    var randomRoomNameGenerator = function () {
                        // predefine the alphabet used.
                        var alphabet = 'qwertyuiopasdfghjklzxcvbnm1234567890';

                        // set the length of the room name
                        var roomNameLength = 30;

                        // initialize the room name as an empty string
                        var roomName = '';

                        // repeat this 30 times
                        for (var i=0; i<roomNameLength; i++) {
                            // get a random character from the alphabet
                            var character = alphabet[Math.round(Math.random()*(alphabet.length-1))];

                            // add the character to the roomName
                            roomName = roomName + character;
                        }

                        // pre- and append appear.in URL elements
                        roomName = 'https://appear.in/' + roomName + '?lite';

                        // return the result
                        return roomName;
                    }

                    // setting a room name. Pair this with the random room generator code above for real power
                    var roomName = randomRoomNameGenerator();

                    // set the iframe source to load the room
                    var iframe = document.getElementById('appearin-room');
                    iframe.setAttribute('src', 'https://appear.in/vevihoPokusnaMistnost');
            }
            
            document.getElementById('join-room-button').onclick = function () {
            
            
            }
            
            

            API.isAppearinCompatible(function (data) {
                if (data.isSupported) {
                    document.getElementById('compatability-test-result').innerHTML = 'Yes';
                }
                else {
                    document.getElementById('compatability-test-result').innerHTML = 'No';
                }
            });
        </script>

    </body>
</html>
